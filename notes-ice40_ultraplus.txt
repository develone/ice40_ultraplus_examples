
This worked was all done on a Raspberry Pi5 with mostly older versions of icestorm, yosys, uf2-utils 
and nextpnr.
 
icestorm:
commit d20a5e9001f46262bf0cef220f1a6943946e421d (HEAD -> master, origin/master, origin/HEAD)
Merge: 5991092 dd2dce8
Author: myrtle <gatecat@ds0.me>
Date:   Sat Feb 18 16:37:53 2023 +0100

    Merge pull request #311 from YosysHQ/fix-wasm-compat
    
    icebram: fix WebAssembly compatibility

yosys:
commit b52f6cb1991b7117d23fa119bf808f9fc1849789 (HEAD -> master, origin/master, origin/HEAD)
Author: github-actions[bot] <41898282+github-actions[bot]@users.noreply.github.com>
Date:   Sat Sep 30 00:14:39 2023 +0000

    Bump version

nextpnr:
commit e8602fb56dce316be506fb69a12f6380eb113712 (HEAD -> master, origin/master, origin/HEAD)
Author: rowanG077 <goemansrowan@gmail.com>
Date:   Thu Sep 28 14:26:13 2023 +0200

    std::numeric_limits<delay_t>::lowest() -> ::min()

uf2-utils:
commit 3ca6d147efad7e3bcc099805e923e60102d0394b (HEAD -> test-dev, origin/test-dev, origin/main, origin/HEAD)
Author: Josuah Demangeon <me@josuah.net>
Date:   Thu Jul 11 15:25:26 2024 +0200

    Makefile: fix a missing variable definition not in C99
    
    Fixes #1
I forked https://github.com/damdoy/ice40_ultraplus_examples.git

Created a new branch test-dev.

These mods should be added as examples to pico-ice-sdk.

Mods done to the following git clone https://github.com/develone/ice40_ultraplus_examples.git -b test-dev
 bram, spi_hw, spi, dsp, and spram.

bram:
changed Makefile
changed top.v
added make_output.txt
added pico-ice.pcf
created top.bin
created test-top.uf2
created notes-bram.txt
https://github.com/develone/ice40_ultraplus_examples/blob/test-dev/bram/make_output.txt/#L2070-L2085

spi_hw:
changed Makefile
changed top.v
added make_output.txt
added pico-ice.pcf
created top.bin
created test-top.uf2
created notes-spi_hw.txt
https://github.com/develone/ice40_ultraplus_examples/blob/test-dev/spi_hw/make_output.txt#L1716-L1731

spi:
changed Makefile
changed top.v
added make_output.txt
added pico-ice.pcf
created top.bin
created test-top.uf2
created notes-spi.txt

dsp:
changed Makefile
changed top.v
added make_output.txt
added pico-ice.pcf
created top.bin
created test-top.uf2
created notes-dsp.txt
https://github.com/develone/ice40_ultraplus_examples/blob/test-dev/dsp/make_output.txt/#L1294-L1309

spram:
changed Makefile
changed top.v
added make_output.txt
added pico-ice.pcf
created top.bin
created test-top.uf2
created notes_spram.txt
https://github.com/develone/ice40_ultraplus_examples/blob/test-dev/spram/make_output.txt#L1307-L1322

find . -name test-top.uf2
./spi_hw/test-top.uf2
./dsp/test-top.uf2
./spi/test-top.uf2
./bram/test-top.uf2
./spram/test-top.uf2

On a 2nd system pi5-70a

git clone https://github.com/develone/ice40_ultraplus_examples.git -b test-dev

cd ice40_ultraplus_example

cd bram/

make clean ; make ; bin2uf2 -o test-top.uf2 top.bin

ls to see if test-top.uf2 was created.

cd ../dsp/

make clean ; make ; bin2uf2 -o test-top.uf2 top.bin

ls to see if test-top.uf2 was created.

cd ../spram/

make clean ; make ; bin2uf2 -o test-top.uf2 top.bin

cd ../spi

make clean ; make ; bin2uf2 -o test-top.uf2 top.bin

ls to see if test-top.uf2 was created.

cd ../spi_hw/

make clean ; make ; bin2uf2 -o test-top.uf2 top.bin

ls to see if test-top.uf2 was created.

transfer the folder to a system with a pico-ice board for testing.

Test test-top.uf2 files on pico-ice hardware 

scp -r ice40_ultraplus_examples/ pi5-80:~/pi5-70a/ 

cd pi5-70a/ice40_ultraplus_examples/

rm -f /media/devel/pico-ice/test-top.uf2

cp bram/test-top.uf2 /media/devel/pico-ice/ 

rm -f /media/devel/pico-ice/test-top.uf2

cp dsp/test-top.uf2 /media/devel/pico-ice/ 

rm -f /media/devel/pico-ice/test-top.uf2

cp spi/test-top.uf2 /media/devel/pico-ice/ 

rm -f /media/devel/pico-ice/test-top.uf2

cp spi_hw/test-top.uf2 /media/devel/pico-ice/ 

Pico		rp2040
GPIO19		30
GPIO18		29
GND
GPIO17		28
GPIO16		27

Pins used in master-slave pico-examples
			Master					Slave
			Pico		rp2040
SPI0 TX		GPIO19		30			GPIO16
SPI0 SCK	GPIO18		29			GPIO18
GND						GND
SPI0 CSn	GPIO17		28			GPIO17
SPI0 RX		GPIO16		27			GPIO19

Changes needed to pico-ice.pcf used to create ice40_ultraplus_examples/spi_hw/top.bin 
ice40_ultraplus_examples/spi_hw $ diff pico-ice.pcf ~/pico-ice/verilog-uart/nandland/pico-ice.pcf 
42,49c42,45
< set_io SPI_MOSI 17
< set_io SPI_MISO 14
< #set_io -nowarn ICE_SO           14
< #set_io -nowarn ICE_SI           17
< #set_io -nowarn ICE_SCK          15
< set_io SPI_SCK 15
< set_io SPI_SS 16
< #set_io -nowarn ICE_SSN          16
---
> set_io -nowarn ICE_SO           14
> set_io -nowarn ICE_SI           17
> set_io -nowarn ICE_SCK          15
> set_io -nowarn ICE_SSN          16

The ice40_ultraplus_examples/spi_hw/README.md states that following
The host computer, which is a x86 linux computer communicates with the FPGA using the FTDI chip on the breakout board, it runs a C program using the `ftdi.h` library to be able to communicate with the FTDI chip using USB.

The host can send commands such as lighting up the LEDS with a given color and the FPGA can answer to request from the host and send data itself.

Communication is done with packets of a few bytes of data, the master can send 8bytes of data to the slave, the first byte is used as the opcode of the command. The seven next bytes are used as parameters, for example, the LED command, will have the colour of the LED as parameters on the first byte.

```
OPCODE  | Description
0x0     | Nop, does nothing
0x1     | Init, starts the state machine on the fpga side, needs 0x11 as last parameter.
0x2     | Writes 32bits to be inverted by the fpga.
0x4     | Writes led value to be on the breakout board. (RGB, LSB is R)
0x6     | The host computer will send 4*32bits values (vector)
0x7     | Reads the 4*32bits values
```

The vector commands (0x6 and 0x7) are used to test the ability of the system to receive multiple data in a short burst.

The rp2040 on the pico-ice needs to be be programmed to perform to do the commuications between the iCE40UP5K and the rp2040.


